<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Global Uptime Monitor</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  background:#0f0f0f;
  color:#eee;
  font-family:Arial;
  margin:0;
  padding:20px;
}
h1 { text-align:center; font-size:32px; }
.container { max-width:1400px; margin:auto; }

input {
  width:70%;
  padding:12px;
  background:#1a1a1a;
  border:1px solid #333;
  color:#fff;
  border-radius:6px;
}

button {
  padding:12px 20px;
  background:#00ffff;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.status-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:12px;
  margin-top:25px;
}

.card {
  background:#1a1a1a;
  padding:15px;
  border-radius:8px;
  border:1px solid #333;
}

.ok { color:#00ff88; }
.err { color:#ff4444; }

.log {
  margin-top:25px;
  background:#111;
  padding:15px;
  height:200px;
  overflow:auto;
  border-radius:8px;
  font-size:13px;
}

canvas { margin-top:30px; }
</style>
</head>
<body>

<div class="container">
<h1>üåç Global Uptime Monitor</h1>

<input id="target" placeholder="https://example.com">
<button onclick="start()">Start</button>

<div class="status-grid" id="grid"></div>

<canvas id="chart"></canvas>

<div class="log" id="log"></div>
</div>

<script>
const countries = [
"Indonesia","India","China","Japan","Korea","Singapore",
"USA","UK","Germany","France","Australia","Brazil",
"Canada","Russia","Netherlands","Sweden","UAE",
"Malaysia","Thailand","Philippines"
];

let chart;
let success = 0;
let total = 0;

function log(msg){
  const logBox = document.getElementById("log");
  logBox.innerHTML += msg + "<br>";
  logBox.scrollTop = logBox.scrollHeight;
}

function initChart(){
  const ctx = document.getElementById("chart");
  chart = new Chart(ctx,{
    type:"line",
    data:{
      labels:[],
      datasets:[{
        label:"Uptime %",
        data:[],
        borderColor:"#00ffff",
        backgroundColor:"rgba(0,255,255,0.1)",
        fill:true,
        tension:0.3
      }]
    },
    options:{ scales:{ y:{ min:0, max:100 } } }
  });
}

async function check(url,country,card){
  try{
    const res = await fetch(`/check?url=${encodeURIComponent(url)}`);
    const data = await res.json();

    total++;

    if(data.status === 200) success++;

    const uptime = ((success/total)*100).toFixed(2);

    if(data.status === 200){
      card.innerHTML = `<b>${country}</b><br>
      <span class="ok">200 OK</span><br>
      ${data.responseTime} ms`;
    } else {
      card.innerHTML = `<b>${country}</b><br>
      <span class="err">${data.status}</span><br>
      ${data.statusText || data.message}`;
      log(`[${country}] ERROR: ${data.status} ${data.statusText || data.message}`);
    }

    chart.data.labels.push(new Date().toLocaleTimeString());
    chart.data.datasets[0].data.push(uptime);

    if(chart.data.labels.length > 30){
      chart.data.labels.shift();
      chart.data.datasets[0].data.shift();
    }

    chart.update();

  } catch(e){
    card.innerHTML = `<b>${country}</b><br>
    <span class="err">Network Error</span>`;
    log(`[${country}] ${e.message}`);
  }
}

function start(){
  const url = document.getElementById("target").value;
  if(!url) return alert("Enter URL");

  document.getElementById("grid").innerHTML="";
  success=0;
  total=0;

  initChart();

  countries.forEach(country=>{
    const card = document.createElement("div");
    card.className="card";
    document.getElementById("grid").appendChild(card);

    setInterval(()=> check(url,country,card),1000);
  });
}
</script>

</body>
</html></html>
